@{
    ViewBag.Title = "Ver Historia Clínica";
    var nombrePaciente = "Juan Pérez"; // Este valor puede ser dinámico según el contexto
}

<h2 class="historial-header">Historia Clínica de @nombrePaciente</h2>

<div class="historial-section">
    <h4>Detalle de la Consulta</h4>
    <div class="table-responsive">
        <table class="table table-striped table-bordered historial-table">
            <thead class="thead-dark">
                <tr>
                    <th>Fecha de Consulta</th>
                    <th>Diagnóstico</th>
                    <th>Tratamiento</th>
                    <th>Medicación</th>
                    <th>Observaciones</th>
                </tr>
            </thead>
            <tbody>
                <!-- Aquí se llenarán los datos del historial clínico -->
                <tr>
                    <td>01/08/2024</td>
                    <td>Caries Dental</td>
                    <td>Obturación</td>
                    <td>Amoxicilina</td>
                    <td>Revisar en 6 meses</td>
                </tr>
            </tbody>
        </table>
    </div>
</div>

<div class="historial-section">
    <h4>Documentos Asociados</h4>
    <div class="historial-docs">
        <div class="doc-item text-center">
            <i class="fas fa-file-alt fa-4x"></i>
            <p>Radiografía del 01/08/2024</p>
            <a href="@Url.Action("DescargarDocumento", "Historial", new { id = 1 })" class="btn btn-secondary btn-sm descargar-btn">Descargar</a>
        </div>
        <div class="doc-item text-center">
            <i class="fas fa-file-alt fa-4x"></i>
            <p>Radiografía del 01/08/2024</p>
            <a href="@Url.Action("DescargarDocumento", "Historial", new { id = 2 })" class="btn btn-secondary btn-sm descargar-btn">Descargar</a>
        </div>
        <div class="doc-item text-center">
            <i class="fas fa-file-alt fa-4x"></i>
            <p>Radiografía del 01/08/2024</p>
            <a href="@Url.Action("DescargarDocumento", "Historial", new { id = 3 })" class="btn btn-secondary btn-sm descargar-btn">Descargar</a>
        </div>
    </div>
</div>

<div class="historial-section text-center">
    @if (Session["RolUsuario"].ToString() == "1")
    {
        <!-- Regresar para el Admin -->
        <a href="@Url.Action("IndexHistorialAdmin", "Historial")" class="btn btn-info">Regresar al Historial</a>
    }
    else if (Session["RolUsuario"].ToString() == "2")
    {
        <!-- Regresar para el Usuario -->
        <a href="@Url.Action("IndexHistorial", "Historial")" class="btn btn-info">Regresar al Historial</a>
    }
</div>

<script>
    document.querySelectorAll('.descargar-btn').forEach(function(btn) {
        btn.addEventListener('click', function(event) {
            event.preventDefault();

            Swal.fire({
                title: '¿Descargar el archivo?',
                text: 'Confirme si desea descargar este archivo.',
                icon: 'question',
                showCancelButton: true,
                confirmButtonText: 'Descargar',
                cancelButtonText: 'X'
            }).then((result) => {
                if (result.isConfirmed) {
                    Swal.fire(
                        'Archivo Descargado',
                        'El archivo se ha descargado con éxito.',
                        'success'
                    ).then(function() {
                        window.location.href = '@Url.Action("VerHistoria", "Historial")';
                    });
                }
            });
        });
    });
</script>
