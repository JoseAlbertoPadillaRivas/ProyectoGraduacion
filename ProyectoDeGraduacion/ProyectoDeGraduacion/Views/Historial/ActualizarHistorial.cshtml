@model ProyectoDeGraduacion.BaseDatos.tHistorial
@{
    ViewBag.Title = "Modificar Historia Clínica";
}

<h2 class="historial-header">Modificar Historia Clínica</h2>

<div class="historial-section">
    @if (ViewBag.msj != null)
    {
        <div class="alert alert-info" role="alert" style="text-align:center">
            @ViewBag.msj
        </div>
    }
    @using (Html.BeginForm("ActualizarHistorial", "Historial", FormMethod.Post, new { @id = "modificarForm" }))
    {
        @Html.HiddenFor(m => m.idHistorial)

        <div class="form-group">
            @Html.Label("Paciente")
            @Html.DropDownList("idPaciente", (SelectList)ViewBag.Pacientes, "Seleccione un paciente", new { @class = "form-control", @id = "idPaciente" })
        </div>
        <div class="form-group">
            <label for="fechaConsulta">Fecha de Consulta:</label>
            @Html.TextBoxFor(m => m.FechaConsulta, new { @type = "date", @class = "form-control", @placeholder = "Fecha de la consulta", @id = "fechaConsulta" })
        </div>
        <div class="form-group">
            <label for="diagnostico">Diagnóstico:</label>
            @Html.TextBoxFor(m => m.Diagnostico, new { @type = "text", @class = "form-control", @placeholder = "Diagnostico", @id = "diagnostico" })
        </div>
        <div class="form-group">
            <label for="tratamiento">Tratamiento Aplicado:</label>
            @Html.TextBoxFor(m => m.Tratamiento, new { @type = "text", @class = "form-control", @placeholder = "Tratamiento aplicado", @id = "tratamiento" })
        </div>
        <div class="form-group">
            <label for="medicacion">Medicación Recetada:</label>
            @Html.TextBoxFor(m => m.Medicacion, new { @type = "text", @class = "form-control", @placeholder = "Medicacion aplicada", @id = "medicacion" })
        </div>
        <div class="form-group">
            <label for="observaciones">Observaciones:</label>
            @Html.TextBoxFor(m => m.Observaciones, new { @type = "text", @class = "form-control", @placeholder = "Observaciones", @id = "observaciones" })
        </div>
        <div>
            <button type="submit" class="btn btn-dark">Actualizar Historial</button>
        </div>
    }
</div>

@*<script>
    document.getElementById("modificarForm").addEventListener("submit", function (event) {
        // Validar campos antes de enviar el formulario
        let paciente = document.getElementById("idPaciente").value;
        let fechaConsulta = document.getElementById("fechaConsulta").value;
        let diagnostico = document.getElementById("diagnostico").value;
        let tratamiento = document.getElementById("tratamiento").value;
        let medicacion = document.getElementById("medicacion").value;
        let observaciones = document.getElementById("observaciones").value;

        if (!paciente || paciente === "Seleccione un paciente") {
            event.preventDefault();
            Swal.fire("Error", "Por favor, selecciona un paciente.", "error");
            return;
        }
        if (!fechaConsulta) {
            event.preventDefault();
            Swal.fire("Error", "Por favor, selecciona una fecha de consulta.", "error");
            return;
        }
        if (!diagnostico) {
            event.preventDefault();
            Swal.fire("Error", "Por favor, ingresa un diagnóstico.", "error");
            return;
        }
        if (!tratamiento) {
            event.preventDefault();
            Swal.fire("Error", "Por favor, ingresa un tratamiento.", "error");
            return;
        }
        if (!medicacion) {
            event.preventDefault();
            Swal.fire("Error", "Por favor, ingresa una medicación.", "error");
            return;
        }
        if (!observaciones) {
            event.preventDefault();
            Swal.fire("Error", "Por favor, ingresa observaciones.", "error");
            return;
        }

        // Mensaje de confirmación antes de enviar el formulario
        event.preventDefault();
        Swal.fire({
            title: '¿Estás seguro?',
            text: 'Los cambios en la historia clínica se guardarán.',
            icon: 'warning',
            showCancelButton: true,
            confirmButtonText: 'Sí, guardar',
            cancelButtonText: 'Cancelar'
        }).then((result) => {
            if (result.isConfirmed) {
                // Enviar el formulario si el usuario confirma
                document.getElementById("modificarForm").submit();
            }
        });
    });
</script>*@
